<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube Thumbnail Generator</title>

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

    <script>
        tailwind.config = {
            darkMode: 'class'
        }
    </script>

    <style>
        .main-title {
            background: linear-gradient(90deg, #7F1D1D, #000000);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .gradient-header {
            background: linear-gradient(
                135deg,
                rgba(127, 29, 29, 0.08),
                rgba(0, 0, 0, 0.05)
            );
            border: 1px dashed #D6C3B3;
        }

        /* ðŸ”¥ Glass container */
        .glass-container {
            background: rgba(255, 247, 237, 0.75);
            backdrop-filter: blur(14px);
            -webkit-backdrop-filter: blur(14px);
            border: 3px solid #7F1D1D;
            border-radius: 28px;
            box-shadow: 0 25px 60px rgba(127, 29, 29, 0.15);
        }

        .inner-card {
            background: rgba(255, 253, 248, 0.95);
            border: 1px solid #E7D8C9;
            border-radius: 20px;
        }

        .thumb-box {
            border: 1px solid #E7D8C9;
            border-radius: 12px;
            overflow: hidden;
        }

        .error {
            background: rgba(127, 29, 29, 0.12);
            color: #7F1D1D;
            border-left: 4px solid #7F1D1D;
        }

        .dark .glass-container {
            background: rgba(30, 27, 22, 0.75);
            border-color: #DC2626;
        }

        .dark .inner-card,
        .dark .thumb-box {
            background: rgba(30, 27, 22, 0.9);
            border-color: #3A3028;
            color: #E7E5E4;
        }

        .dark .gradient-header {
            border-color: #3A3028;
        }
    </style>
</head>

<body class="bg-[#FFF7ED] text-black min-h-screen transition-colors duration-300
             dark:bg-[#1E1B16] dark:text-[#E7E5E4]">

<!-- Navbar -->
<div th:replace="~{fragments/navbar :: navbar}" th:with="activePage='thumbnails'"></div>

<div class="container mx-auto px-4 max-w-3xl mt-14 pb-14">

    <!-- OUTER GLASS CONTAINER -->
    <div class="glass-container p-6 md:p-8">

        <!-- Header -->
        <div class="text-center mb-10">
            <h1 class="main-title text-4xl md:text-5xl font-extrabold mb-4">
                YouTube Thumbnail Generator
            </h1>

            <div class="gradient-header rounded-xl p-4 mt-6">
                <p class="text-black dark:text-[#A8A29E] text-lg">
                    Enter a YouTube video URL or ID to get a high resolution thumbnail (1280Ã—720).
                </p>
            </div>
        </div>

        <!-- Form -->
        <div class="inner-card shadow-lg p-6 mb-8">

            <form th:action="@{/get-thumbnail}" method="post">

                <label for="videoUrlOrId"
                       class="block text-sm font-medium mb-2">
                    YouTube Video URL or ID
                </label>

                <input type="text" id="videoUrlOrId" name="videoUrlOrId" required
                       class="w-full px-4 py-3 rounded-lg
                              bg-[#FFF7ED] dark:bg-[#2A211B]
                              border border-[#D6C3B3] dark:border-[#3A3028]
                              focus:border-[#7F1D1D]
                              focus:ring-2 focus:ring-[#7F1D1D]/30
                              transition-colors duration-200 mb-4">

                <button type="submit"
                        class="w-full bg-[#FFF7ED] hover:bg-[#7F1D1D]
                               text-black hover:text-white
                               border border-[#7F1D1D]
                               font-medium py-3 px-6
                               rounded-lg shadow-lg transition-colors">
                    Get Thumbnail
                </button>
            </form>

            <!-- Error -->
            <div th:if="${error}" class="error rounded-lg p-4 mt-4" th:text="${error}"></div>
        </div>

        <!-- Thumbnail Result -->
        <div th:if="${thumbnailUrl}" class="inner-card shadow-lg p-6">

            <h2 class="text-xl font-semibold mb-4">
                High Quality Thumbnail (1280Ã—720)
            </h2>

            <div class="flex justify-end mb-4">
                <button type="button"
                        onclick="downloadImage('[[${thumbnailUrl}]]', 'youtube-thumbnail-[[${videoId}]]-hq.jpg')"
                        class="bg-[#FFF7ED] hover:bg-[#7F1D1D]
                               text-black hover:text-white
                               border border-[#7F1D1D]
                               font-medium py-2 px-4 rounded-lg transition-colors">
                    Download Thumbnail
                </button>
            </div>

            <div class="thumb-box p-4">
                <img th:src="${thumbnailUrl}"
                     alt="YouTube thumbnail high quality"
                     class="w-full h-auto"
                     onerror="this.onerror=null;
                              this.src='https://via.placeholder.com/1280x720?text=Thumbnail+Not+Available';">
            </div>
        </div>

    </div>
</div>

<script>
    function downloadImage(url, filename) {
        fetch(url, { mode: 'cors' })
            .then(res => res.blob())
            .then(blob => {
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = filename;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            })
            .catch(() => alert('Failed to download thumbnail.'));
    }
</script>

</body>
</html>
